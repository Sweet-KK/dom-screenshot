(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e():"function"===typeof define&&define.amd?define([],e):"object"===typeof exports?exports["dom-screenshot"]=e():t["dom-screenshot"]=e()})("undefined"!==typeof self?self:this,(function(){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="fb15")}({"21a6":function(t,e,n){(function(n){var o,i,r;(function(n,a){i=[],o=a,r="function"===typeof o?o.apply(e,i):o,void 0===r||(t.exports=r)})(0,(function(){"use strict";function e(t,e){return"undefined"==typeof e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}function o(t,e,n){var o=new XMLHttpRequest;o.open("GET",t),o.responseType="blob",o.onload=function(){c(o.response,e,n)},o.onerror=function(){console.error("could not download file")},o.send()}function i(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function r(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(o){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n&&n.global===n?n:void 0,s=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(t,e,n){var s=a.URL||a.webkitURL,c=document.createElement("a");e=e||t.name||"download",c.download=e,c.rel="noopener","string"==typeof t?(c.href=t,c.origin===location.origin?r(c):i(c.href)?o(t,e,n):r(c,c.target="_blank")):(c.href=s.createObjectURL(t),setTimeout((function(){s.revokeObjectURL(c.href)}),4e4),setTimeout((function(){r(c)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,n,a){if(n=n||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(e(t,a),n);else if(i(t))o(t,n,a);else{var s=document.createElement("a");s.href=t,s.target="_blank",setTimeout((function(){r(s)}))}}:function(t,e,n,i){if(i=i||open("","_blank"),i&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof t)return o(t,e,n);var r="application/octet-stream"===t.type,c=/constructor/i.test(a.HTMLElement)||a.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||r&&c||s)&&"undefined"!=typeof FileReader){var l=new FileReader;l.onloadend=function(){var t=l.result;t=u?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=t:location=t,i=null},l.readAsDataURL(t)}else{var f=a.URL||a.webkitURL,d=f.createObjectURL(t);i?i.location=d:location.href=d,i=null,setTimeout((function(){f.revokeObjectURL(d)}),4e4)}});a.saveAs=c.saveAs=c,t.exports=c}))}).call(this,n("c8ba"))},"32e6":function(t,e){function n(t,e){for(var n in e)t.setAttribute(n,e[n])}function o(t,e){t.onload=function(){this.onerror=this.onload=null,e(null,t)},t.onerror=function(){this.onerror=this.onload=null,e(new Error("Failed to load "+this.src),t)}}function i(t,e){t.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||(this.onreadystatechange=null,e(null,t))}}t.exports=function(t,e,r){var a=document.head||document.getElementsByTagName("head")[0],s=document.createElement("script");"function"===typeof e&&(r=e,e={}),e=e||{},r=r||function(){},s.type=e.type||"text/javascript",s.charset=e.charset||"utf8",s.async=!("async"in e)||!!e.async,s.src=t,e.attrs&&n(s,e.attrs),e.text&&(s.text=""+e.text);var c="onload"in s?o:i;c(s,r),s.onload||o(s,r),a.appendChild(s)}},5555:function(t,e){t.exports={}},"70bb":function(t,e,n){"use strict";var o=n("5555"),i=n.n(o);e["default"]=i.a},8875:function(t,e,n){var o,i,r;(function(n,a){i=[],o=a,r="function"===typeof o?o.apply(e,i):o,void 0===r||(t.exports=r)})("undefined"!==typeof self&&self,(function(){function t(){var e=Object.getOwnPropertyDescriptor(document,"currentScript");if(!e&&"currentScript"in document&&document.currentScript)return document.currentScript;if(e&&e.get!==t&&document.currentScript)return document.currentScript;try{throw new Error}catch(p){var n,o,i,r=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,a=/@([^@]*):(\d+):(\d+)\s*$/gi,s=r.exec(p.stack)||a.exec(p.stack),c=s&&s[1]||!1,u=s&&s[2]||!1,l=document.location.href.replace(document.location.hash,""),f=document.getElementsByTagName("script");c===l&&(n=document.documentElement.outerHTML,o=new RegExp("(?:[^\\n]+?\\n){0,"+(u-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),i=n.replace(o,"$1").trim());for(var d=0;d<f.length;d++){if("interactive"===f[d].readyState)return f[d];if(f[d].src===c)return f[d];if(c===l&&f[d].innerHTML&&f[d].innerHTML.trim()===i)return f[d]}return null}}return t}))},b635:function(t,e,n){"use strict";(function(t){var o=n("e000");o["a"].install=t=>{t.component(o["a"].name,o["a"])};let i=null;"undefined"!==typeof window?i=window.Vue:"undefined"!==typeof t&&(i=t.Vue),i&&i.use(o["a"]),e["a"]=o["a"]}).call(this,n("c8ba"))},c8ba:function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(o){"object"===typeof window&&(n=window)}t.exports=n},e000:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",t._g(t._b({ref:"targetDom",staticClass:"dom-screenshot"},"div",t.$attrs,!1),t.$listeners),[t._t("default",[t._v(" Hellow Word! ")])],2)},i=[],r=n("21a6");const a=n("32e6"),s={jpg:{fn:"toJpeg",suffix:"jpg"},png:{fn:"toPng",suffix:"png"},blob:{fn:"toBlob",suffix:"png"}};var c={name:"DomScreenshot",props:{beforeShot:{type:Function,default:null},saveName:{type:String,default:"生成图片"},scale:{type:Number,default:2},quality:{type:Number,default:.9},isSave:{type:Boolean,default:!1},distType:{type:String,default:"jpg"},cacheBust:{type:Boolean,default:!1},bgColor:{type:[String,null],default:null},options:{type:Object,default:()=>({})},useHtml2canvas:{type:Boolean,default:void 0},cdns:{type:Object,default:()=>({domtoimage:"//cdn.bootcdn.net/ajax/libs/dom-to-image/2.6.0/dom-to-image.js",html2canvas:"//html2canvas.hertzen.com/dist/html2canvas.min.js"})}},data(){return{useAnother:!1}},mounted(){void 0===this.useHtml2canvas?this.useAnother=/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)||navigator.userAgent.toLowerCase().includes("msie")||navigator.userAgent.toLowerCase().includes("trident"):this.useAnother=this.useHtml2canvas},methods:{getOption(t){if(this.useAnother){const e=this.getOffset(t);return{allowTaint:!0,useCORS:!0,x:e.left,y:e.top,width:e.width,height:e.height,...this.options,scale:this.scale,backgroundColor:this.bgColor}}return{width:t.offsetWidth*this.scale,height:t.offsetHeight*this.scale,style:{transform:`scale(${this.scale})`,transformOrigin:"0 0",width:t.offsetWidth+"px",height:t.offsetHeight+"px"},imagePlaceholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAABkCAYAAADDhn8LAAACpUlEQVR4Xu3VsRHDMAwEQbH/BtmN3YDl4NJf5Qiw4I3Ovffz+AgQ+ClwBOJlEHgXEIjXQeCPgEA8DwIC8QYINAF/kOZmakRAICOHtmYTEEhzMzUiIJCRQ1uzCQikuZkaERDIyKGt2QQE0txMjQgIZOTQ1mwCAmlupkYEBDJyaGs2AYE0N1MjAgIZObQ1m4BAmpupEQGBjBzamk1AIM3N1IiAQEYObc0mIJDmZmpEQCAjh7ZmExBIczM1IiCQkUNbswkIpLmZGhEQyMihrdkEBNLcTI0ICGTk0NZsAgJpbqZGBAQycmhrNgGBNDdTIwICGTm0NZuAQJqbqREBgYwc2ppNQCDNzdSIgEBGDm3NJiCQ5mZqREAgI4e2ZhMQSHMzNSIgkJFDW7MJCKS5mRoREMjIoa3ZBATS3EyNCAhk5NDWbAICaW6mRgQEMnJoazYBgTQ3UyMCAhk5tDWbgECam6kRAYGMHNqaTUAgzc3UiIBARg5tzSYgkOZmakRAICOHtmYTEEhzMzUiIJCRQ1uzCQikuZkaERDIyKGt2QQE0txMjQgIZOTQ1mwCAmlupkYEBDJyaGs2AYE0N1MjAgIZObQ1m4BAmpupEQGBjBzamk1AIM3N1IiAQEYObc0mIJDmZmpEQCAjh7ZmExBIczM1IiCQkUNbswkIpLmZGhEQyMihrdkEBNLcTI0ICGTk0NZsAgJpbqZGBAQycmhrNgGBNDdTIwICGTm0NZuAQJqbqREBgYwc2ppNQCDNzdSIgEBGDm3NJiCQ5mZqREAgI4e2ZhMQSHMzNSIgkJFDW7MJCKS5mRoREMjIoa3ZBATS3EyNCAhk5NDWbAICaW6mRgQEMnJoazYBgTQ3UyMCAhk5tDWbgECam6kRAYGMHNqaTUAgzc3UiMAXqPVhMNxoJT0AAAAASUVORK5CYII=",...this.options,scale:this.scale,quality:this.quality,cacheBust:this.cacheBust,bgcolor:this.bgColor}},getOffset(t){let e=t.offsetTop,n=t.offsetLeft,o=t.offsetParent;while(o)e+=o.offsetTop,n+=o.offsetLeft,o=o.offsetParent;return{top:e,left:n,width:t.offsetWidth,height:t.offsetHeight}},shot(){const t=this.ignoreMultiClick(this.dealHandle);if(!this.beforeShot)return t();const e=this.beforeShot();if(e&&e.then)e.then(()=>t());else if(!1!==e)return t()},async conmonHandle(){console.log("domtoimage");const t=this.$refs.targetDom,e=this.getFileName(),n=s[this.distType].fn;return window.domtoimage||await this.loadScript(this.cdns.domtoimage),window.domtoimage[n](t,this.getOption(t)).then(t=>(this.saveFile(t,e),t)).catch(t=>t)},async anotherHandle(){console.log("html2canvas");const t=this.$refs.targetDom,e=this.getFileName();if(window.html2canvas||await this.loadScript(this.cdns.html2canvas),this.cacheBust){const e=t.querySelectorAll("img");if(e.length)for(let t=0;t<e.length;t++){const n=e[t],o=n.src;if(o.includes(";base64,")||!o)continue;const i=await this.imageLoadBlob(o);i&&(n.src=i)}}return window.html2canvas(t,this.getOption(t)).then(t=>{const n=this.canvasToData(t,this.distType);return this.saveFile(n,e),n}).catch(t=>t)},loadScript(t,e={}){return new Promise((n,o)=>{a(t,e,(function(t,e){t?o(t):n()}))})},imageLoadBlob(t){const e=t+(/\?/.test(t)?"&":"?")+(new Date).getTime();return new Promise(n=>{const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(4!==o.readyState)return;if(200!==o.status)return console.error("cannot fetch resource: "+t),void n(t);const i=new FileReader;i.onloadend=()=>{const t=i.result.split(/,/)[1],o=this.parseExtension(e).toLowerCase(),r=this.mimes()[o]||"";n("data:"+r+";base64,"+t)},i.readAsDataURL(o.response)},o.ontimeout=()=>{n(t),console.error("fetch resource timeout: "+t)},o.responseType="blob",o.timeout=1e4,o.open("GET",e,!0),o.send()})},parseExtension(t){const e=/\.([^\.\/]*?)$/g.exec(t);return e?e[1]:""},mimes(){const t="application/font-woff",e="image/jpeg";return{woff:t,woff2:t,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:e,jpeg:e,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}},dealHandle(){return this.useAnother?this.anotherHandle():this.conmonHandle()},ignoreMultiClick(t,e=!1){let n=!1;return function(...o){if(n)return;n=!0;const i=()=>n=!1;if(e)return t.call(this,...o,i);const r=t.call(this,...o);return Promise.resolve(r).finally(i),r}},blobToFile(t,e){return t.lastModifiedDate=new Date,t.name=e,t},getFileName(){return this.saveName+"."+s[this.distType].suffix},saveFile(t,e){this.isSave&&Object(r["saveAs"])(t,e)},canvasToData(t,e){if("jpg"===e)return t.toDataURL("image/jpeg",this.quality);if("png"===e)return t.toDataURL();{if(t.toBlob)return new Promise(e=>{t.toBlob(e)});const e=window.atob(t.toDataURL().split(",")[1]),n=e.length,o=new Uint8Array(n);for(let t=0;t<n;t++)o[t]=e.charCodeAt(t);return new Blob([o],{type:"image/png"})}}}},u=c;function l(t,e,n,o,i,r,a,s){var c,u="function"===typeof t?t.options:t;if(e&&(u.render=e,u.staticRenderFns=n,u._compiled=!0),o&&(u.functional=!0),r&&(u._scopeId="data-v-"+r),a?(c=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},u._ssrRegister=c):i&&(c=s?function(){i.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:i),c)if(u.functional){u._injectStyles=c;var l=u.render;u.render=function(t,e){return c.call(e),l(t,e)}}else{var f=u.beforeCreate;u.beforeCreate=f?[].concat(f,c):[c]}return{exports:t,options:u}}var f=n("70bb"),d=l(u,o,i,!1,null,null,null);"function"===typeof f["default"]&&Object(f["default"])(d);e["a"]=d.exports},fb15:function(t,e,n){"use strict";if(n.r(e),"undefined"!==typeof window){var o=window.document.currentScript,i=n("8875");o=i(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:i});var r=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);r&&(n.p=r[1])}var a=n("b635");e["default"]=a["a"]}})}));
//# sourceMappingURL=dom-screenshot.umd.min.js.map